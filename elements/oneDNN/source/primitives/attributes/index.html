

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Attributes &mdash; oneAPI Specification 0.7 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../../_static/favicons.png"/>
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
        <script src="../../../../../_static/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="Scratchpad Mode" href="scratchpad.html" />
    <link rel="prev" title="Common definitions" href="../general.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://oneapi.com" class="icon icon-home"> oneAPI Specification
          

          
            
            <img src="../../../../../_static/oneAPI-rgb-rev-100.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../architecture.html">Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../library-interop.html">Library Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../elements.html">oneAPI Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dpcpp/source/index.html">DPC++ 0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneDPL/source/index.html">oneDPL 0.7</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">oneDNN 0.7</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../execution_model/index.html">Execution Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_model/index.html">Data model</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Primitives</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../general.html">Common definitions</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="scratchpad.html">Scratchpad Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="quantization.html">Quantization</a></li>
<li class="toctree-l4"><a class="reference internal" href="post-ops.html">Post-ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attribute-related-error-handling">Attribute Related Error Handling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../convolution.html">Convolution and Deconvolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../inner-product.html">Inner Product</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rnn.html">RNN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../normalization.html">Normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concat.html">Concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../binary.html">Binary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../eltwise.html">Element-wise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../layer_normalization.html">Layer normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lrn.html">Local Response Normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../logsoftmax.html">LogSoftmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pooling.html">Pooling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../resampling.html">Resampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../softmax.html">Softmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../shuffle.html">Shuffle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sum.html">Sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reorder.html">Reorder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../matmul.html">Matrix Multiplication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#id1">Open Source Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#implementation-notes">Implementation Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneCCL/source/index.html">oneCCL 0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../l0/source/index.html">Level Zero 0.91</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneDAL/source/index.html">oneDAL 0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneTBB/source/nested-index.html">oneTBB 0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneVPL/source/index.html">oneVPL 0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../oneMKL/source/index.html">oneMKL 0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../versions.html">HTML and PDF Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../notices.html">Legal Notices and Disclaimers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">oneAPI Specification</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">oneAPI Specification</a> &raquo;</li>
        
          
          <li><a href="../../index.html">oneDNN 0.7</a> </li>
          
        
          
        
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/oneapi-src/oneapi-spec/blob/master/source/elements/oneDNN/source/primitives/attributes/index.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="attributes">
<span id="attributes-link"></span><h1>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">Â¶</a></h1>
<p>The parameters passed to create a primitive descriptor specify the problem. An
engine specifies where the primitive will be executed. An operation descriptor
specifies the basics: the operation kind; the propagation kind; the source,
destination, and other tensors; the strides (if applicable); and so on.</p>
<p><strong>Attributes</strong> specify some extra properties of the primitive. Users must
create them before use and must set required specifics using the corresponding
setters. The attributes are copied during primitive descriptor creation, so
users can change or destroy attributes right after that.</p>
<p>If not modified, attributes can stay empty, which is equivalent to the default
attributes. Primitive descriptorsâ constructors have empty attributes as
default parameters, so unless required users can simply omit them.</p>
<p>Attributes can also contain <em>post-ops</em>, which are computations executed after
the primitive.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="scratchpad.html">Scratchpad Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="quantization.html">Quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="post-ops.html">Post-ops</a></li>
</ul>
</div>
<div class="section" id="attribute-related-error-handling">
<span id="attributes-error-handling-link"></span><h2>Attribute Related Error Handling<a class="headerlink" href="#attribute-related-error-handling" title="Permalink to this headline">Â¶</a></h2>
<p>Since the attributes are created separately from the corresponding primitive
descriptor, consistency checks are delayed.  Users can successfully set
attributes in whatever configuration they want.  However, when they try to
create a primitive descriptor with the attributes they set, it might happen
that there is no primitive implementation that supports such a configuration.
In this case the library will throw the <a class="reference internal" href="../../introduction.html#_CPPv4N4dnnl5errorE" title="dnnl::error"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">dnnl::error</span></code></a> exception.</p>
<p class="rubric">API</p>
<dl class="cpp struct">
<dt id="_CPPv4N4dnnl14primitive_attrE">
<span id="_CPPv3N4dnnl14primitive_attrE"></span><span id="_CPPv2N4dnnl14primitive_attrE"></span><span id="dnnl::primitive_attr"></span><span class="target" id="structdnnl_1_1primitive__attr"></span><em class="property">struct </em><code class="sig-prename descclassname">dnnl<code class="sig-prename descclassname">::</code></code><code class="sig-name descname">primitive_attr</code><a class="headerlink" href="#_CPPv4N4dnnl14primitive_attrE" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Primitive attributes. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="cpp function">
<dt id="_CPPv4N4dnnl14primitive_attr14primitive_attrEv">
<span id="_CPPv3N4dnnl14primitive_attr14primitive_attrEv"></span><span id="_CPPv2N4dnnl14primitive_attr14primitive_attrEv"></span><span id="dnnl::primitive_attr::primitive_attr"></span><span class="target" id="structdnnl_1_1primitive__attr_1acfbfd85b7ca82bf97e2b07c2427427de"></span><code class="sig-name descname">primitive_attr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl14primitive_attr14primitive_attrEv" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Constructs default (empty) primitive attributes. </p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl14primitive_attr19get_scratchpad_modeEv">
<span id="_CPPv3NK4dnnl14primitive_attr19get_scratchpad_modeEv"></span><span id="_CPPv2NK4dnnl14primitive_attr19get_scratchpad_modeEv"></span><span id="dnnl::primitive_attr::get_scratchpad_modeC"></span><span class="target" id="structdnnl_1_1primitive__attr_1af4131b946ec3af3bc2974b603d30029b"></span><a class="reference internal" href="scratchpad.html#_CPPv4N4dnnl15scratchpad_modeE" title="dnnl::scratchpad_mode">scratchpad_mode</a> <code class="sig-name descname">get_scratchpad_mode</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl14primitive_attr19get_scratchpad_modeEv" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Returns the scratchpad mode. </p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl14primitive_attr19set_scratchpad_modeE15scratchpad_mode">
<span id="_CPPv3N4dnnl14primitive_attr19set_scratchpad_modeE15scratchpad_mode"></span><span id="_CPPv2N4dnnl14primitive_attr19set_scratchpad_modeE15scratchpad_mode"></span><span id="dnnl::primitive_attr::set_scratchpad_mode__scratchpad_mode"></span><span class="target" id="structdnnl_1_1primitive__attr_1a91a597649afa13b7d2416b708d0620d2"></span>void <code class="sig-name descname">set_scratchpad_mode</code><span class="sig-paren">(</span><a class="reference internal" href="scratchpad.html#_CPPv4N4dnnl15scratchpad_modeE" title="dnnl::scratchpad_mode">scratchpad_mode</a> <em>mode</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl14primitive_attr19set_scratchpad_modeE15scratchpad_mode" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Sets scratchpad mode.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mode</span></code>: Specified scratchpad mode. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl14primitive_attr17get_output_scalesERiRNSt6vectorIfEE">
<span id="_CPPv3NK4dnnl14primitive_attr17get_output_scalesERiRNSt6vectorIfEE"></span><span id="_CPPv2NK4dnnl14primitive_attr17get_output_scalesERiRNSt6vectorIfEE"></span><span id="dnnl::primitive_attr::get_output_scales__iR.std::vector:float:RC"></span><span class="target" id="structdnnl_1_1primitive__attr_1aadcfc1f7a787a0b75d6b0daab8da14af"></span>void <code class="sig-name descname">get_output_scales</code><span class="sig-paren">(</span>int &amp;<em>mask</em>, std::vector&lt;float&gt; &amp;<em>scales</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl14primitive_attr17get_output_scalesERiRNSt6vectorIfEE" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Returns output scaling factors correspondence mask and values.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mask</span></code>: Scaling factors correspondence mask that defines the correspondence between the output tensor dimensions and the <code class="docutils literal notranslate"><span class="pre">scales</span></code> vector. The set i-th bit indicates that a dedicated output scaling factor is used for each index along that dimension. The mask value of 0 implies a common output scaling factor for the whole output tensor. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scales</span></code>: Vector of output scaling factors. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl14primitive_attr17set_output_scalesEiRKNSt6vectorIfEE">
<span id="_CPPv3N4dnnl14primitive_attr17set_output_scalesEiRKNSt6vectorIfEE"></span><span id="_CPPv2N4dnnl14primitive_attr17set_output_scalesEiRKNSt6vectorIfEE"></span><span id="dnnl::primitive_attr::set_output_scales__i.std::vector:float:CR"></span><span class="target" id="structdnnl_1_1primitive__attr_1a4b81acc8e48886313154f75c1708ae02"></span>void <code class="sig-name descname">set_output_scales</code><span class="sig-paren">(</span>int <em>mask</em>, <em class="property">const</em> std::vector&lt;float&gt; &amp;<em>scales</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl14primitive_attr17set_output_scalesEiRKNSt6vectorIfEE" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Sets output scaling factors correspondence mask and values.</p>
<p>Example usage: <div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">mb</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">oc</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
    <span class="n">oh</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n">ow</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span> <span class="o">//</span> <span class="n">convolution</span> <span class="n">output</span> <span class="n">params</span>
<span class="o">//</span> <span class="n">unique</span> <span class="n">output</span> <span class="n">scales</span> <span class="n">per</span> <span class="n">output</span> <span class="n">channel</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span> <span class="n">scales</span> <span class="o">=</span> <span class="p">{</span> <span class="o">...</span> <span class="p">};</span>
<span class="nb">int</span> <span class="n">oc_dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="o">//</span> <span class="n">mb_dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">channel_dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">height_dim</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="o">...</span>

<span class="o">//</span> <span class="n">construct</span> <span class="n">a</span> <span class="n">convolution</span> <span class="n">descriptor</span>
<span class="n">dnnl</span><span class="p">::</span><span class="n">convolution</span><span class="p">::</span><span class="n">desc</span> <span class="n">conv_d</span><span class="p">;</span>

<span class="n">dnnl</span><span class="p">::</span><span class="n">primitive_attr</span> <span class="n">attr</span><span class="p">;</span>
<span class="n">attr</span><span class="o">.</span><span class="n">set_output_scales</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">oc</span><span class="p">,</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">oc_dim</span><span class="p">,</span> <span class="n">scales</span><span class="p">);</span>

<span class="n">dnnl</span><span class="p">::</span><span class="n">primitive_desc</span> <span class="n">conv_pd</span><span class="p">(</span><span class="n">conv_d</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">engine</span><span class="p">);</span>
</pre></div>
</div>
</p>
<p><dl class="simple">
<dt><strong>Note</strong></dt><dd><p>The order of dimensions does not depend on how elements are laid out in memory. For example:<ul class="simple">
<li><p>for a 2D CNN activations tensor the order is always (n, c)</p></li>
<li><p>for a 4D CNN activations tensor the order is always (n, c, h, w)</p></li>
<li><p>for a 5D CNN weights tensor the order is always (g, oc, ic, kh, kw)</p></li>
</ul>
</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mask</span></code>: Defines the correspondence between the output tensor dimensions and the <code class="docutils literal notranslate"><span class="pre">scales</span></code> vector. The set i-th bit indicates that a dedicated scaling factor is used for each index along that dimension. Set the mask to 0 to use a common output scaling factor for the whole output tensor. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scales</span></code>: Constant vector of output scaling factors. If the scaling factors are known at the time of this call, the following equality must hold: <span class="math notranslate nohighlight">\(scales.size() = \prod\limits_{d \in mask} output.dims[d].\)</span> Violations can only be detected when the attributes are used to create a primitive descriptor. If the scaling factors are not known at the time of the call, this vector must contain a single <a class="reference internal" href="../general.html#dnnl__types_8h_1ab16365c11b4dc88fbb453edb51f1979f"><span class="std std-ref">DNNL_RUNTIME_F32_VAL</span></a> value and the output scaling factors must be passed at execution time as an argument with index <a class="reference internal" href="../general.html#dnnl__types_8h_1a0afb48b0c2b8f3ee30609aaa47aa29db"><span class="std std-ref">DNNL_ARG_ATTR_OUTPUT_SCALES</span></a>. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl14primitive_attr10get_scalesEiRiRNSt6vectorIfEE">
<span id="_CPPv3NK4dnnl14primitive_attr10get_scalesEiRiRNSt6vectorIfEE"></span><span id="_CPPv2NK4dnnl14primitive_attr10get_scalesEiRiRNSt6vectorIfEE"></span><span id="dnnl::primitive_attr::get_scales__i.iR.std::vector:float:RC"></span><span class="target" id="structdnnl_1_1primitive__attr_1a9fc7eb58cc958963a2d26743cfd5c763"></span>void <code class="sig-name descname">get_scales</code><span class="sig-paren">(</span>int <em>arg</em>, int &amp;<em>mask</em>, std::vector&lt;float&gt; &amp;<em>scales</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl14primitive_attr10get_scalesEiRiRNSt6vectorIfEE" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Returns scaling factors correspondence mask and values for a given memory argument.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">arg</span></code>: Parameter argument index as passed to the <a class="reference internal" href="../general.html#structdnnl_1_1primitive_1ac3c158d15405ac269c8acd5d6087ba93"><span class="std std-ref">primitive::execute()</span></a> call. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mask</span></code>: Scaling factors correspondence mask that defines the correspondence between the output tensor dimensions and the <code class="docutils literal notranslate"><span class="pre">scales</span></code> vector. The set i-th bit indicates that a dedicated scaling factor is used for each index along that dimension. Set the mask to 0 to use a common scaling factor for the whole output tensor. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scales</span></code>: Output vector of scaling factors. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl14primitive_attr10set_scalesEiiRKNSt6vectorIfEE">
<span id="_CPPv3N4dnnl14primitive_attr10set_scalesEiiRKNSt6vectorIfEE"></span><span id="_CPPv2N4dnnl14primitive_attr10set_scalesEiiRKNSt6vectorIfEE"></span><span id="dnnl::primitive_attr::set_scales__i.i.std::vector:float:CR"></span><span class="target" id="structdnnl_1_1primitive__attr_1a9bf717bd25b6fddd89055da8178eab75"></span>void <code class="sig-name descname">set_scales</code><span class="sig-paren">(</span>int <em>arg</em>, int <em>mask</em>, <em class="property">const</em> std::vector&lt;float&gt; &amp;<em>scales</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl14primitive_attr10set_scalesEiiRKNSt6vectorIfEE" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Sets scaling factors for primitive operations for a given memory argument.</p>
<p><dl class="simple">
<dt><strong>See</strong></dt><dd><p><a class="reference internal" href="#structdnnl_1_1primitive__attr_1a4b81acc8e48886313154f75c1708ae02"><span class="std std-ref">dnnl::primitive_attr::set_output_scales</span></a></p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">arg</span></code>: Parameter argument index as passed to the <a class="reference internal" href="../general.html#structdnnl_1_1primitive_1ac3c158d15405ac269c8acd5d6087ba93"><span class="std std-ref">primitive::execute()</span></a> call. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mask</span></code>: Scaling factors correspondence mask that defines the correspondence between the tensor dimensions and the <code class="docutils literal notranslate"><span class="pre">scales</span></code> vector. The set i-th bit indicates that a dedicated scaling factor is used for each index along that dimension. Set the mask to 0 to use a common scaling factor for the whole output tensor. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scales</span></code>: Constant vector of scaling factors. The following equality must hold: <span class="math notranslate nohighlight">\(scales.size() = \prod\limits_{d \in mask} argument.dims[d].\)</span> </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl14primitive_attr15get_zero_pointsEiRiRNSt6vectorI7int32_tEE">
<span id="_CPPv3NK4dnnl14primitive_attr15get_zero_pointsEiRiRNSt6vectorI7int32_tEE"></span><span id="_CPPv2NK4dnnl14primitive_attr15get_zero_pointsEiRiRNSt6vectorI7int32_tEE"></span><span id="dnnl::primitive_attr::get_zero_points__i.iR.std::vector:int32_t:RC"></span><span class="target" id="structdnnl_1_1primitive__attr_1a010dfd54aa839ca1c0da892b99963bdf"></span>void <code class="sig-name descname">get_zero_points</code><span class="sig-paren">(</span>int <em>arg</em>, int &amp;<em>mask</em>, std::vector&lt;int32_t&gt; &amp;<em>zero_points</em><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl14primitive_attr15get_zero_pointsEiRiRNSt6vectorI7int32_tEE" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Returns zero points correspondence mask and values.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">arg</span></code>: Parameter argument index as passed to the <a class="reference internal" href="../general.html#structdnnl_1_1primitive_1ac3c158d15405ac269c8acd5d6087ba93"><span class="std std-ref">primitive::execute()</span></a> call. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mask</span></code>: Zero points correspondence mask that defines the correspondence between the output tensor dimensions and the <code class="docutils literal notranslate"><span class="pre">zero_points</span></code> vector. The set i-th bit indicates that a dedicated zero point is used for each index along that dimension. Set the mask to 0 to use a common zero point for the whole output tensor. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zero_points</span></code>: Output vector of zero points. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl14primitive_attr15set_zero_pointsEiiRKNSt6vectorI7int32_tEE">
<span id="_CPPv3N4dnnl14primitive_attr15set_zero_pointsEiiRKNSt6vectorI7int32_tEE"></span><span id="_CPPv2N4dnnl14primitive_attr15set_zero_pointsEiiRKNSt6vectorI7int32_tEE"></span><span id="dnnl::primitive_attr::set_zero_points__i.i.std::vector:int32_t:CR"></span><span class="target" id="structdnnl_1_1primitive__attr_1aee82deb014cf9702ceb3e725156c25a1"></span>void <code class="sig-name descname">set_zero_points</code><span class="sig-paren">(</span>int <em>arg</em>, int <em>mask</em>, <em class="property">const</em> std::vector&lt;int32_t&gt; &amp;<em>zero_points</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl14primitive_attr15set_zero_pointsEiiRKNSt6vectorI7int32_tEE" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Sets zero points for primitive operations for a given memory argument.</p>
<p><dl class="simple">
<dt><strong>See</strong></dt><dd><p><a class="reference internal" href="#structdnnl_1_1primitive__attr_1a4b81acc8e48886313154f75c1708ae02"><span class="std std-ref">dnnl::primitive_attr::set_output_scales</span></a></p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">arg</span></code>: Parameter argument index as passed to the <a class="reference internal" href="../general.html#structdnnl_1_1primitive_1ac3c158d15405ac269c8acd5d6087ba93"><span class="std std-ref">primitive::execute()</span></a> call. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mask</span></code>: Zero point correspondence mask that defines the correspondence between the tensor dimensions and the <code class="docutils literal notranslate"><span class="pre">zero_points</span></code> vector. The set i-th bit indicates that a dedicated zero point is used for each index along that dimension. Set the mask to 0 to use a common zero point for the whole output tensor. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zero_points</span></code>: Constant vector of zero points. If the zero points are known at the time of this call, the following equality must hold: <span class="math notranslate nohighlight">\(zero\_points.size() = \prod\limits_{d \in mask} argument.dims[d].\)</span> If the zero points are not known at the time of the call, this vector must contain a single <a class="reference internal" href="../general.html#dnnl__types_8h_1ab16365c11b4dc88fbb453edb51f1979f"><span class="std std-ref">DNNL_RUNTIME_F32_VAL</span></a> value and the zero points must be passed at execution time as an argument with index <a class="reference internal" href="../general.html#dnnl__types_8h_1af8d879adfe2baa2f9f2a5143a0f274b6"><span class="std std-ref">DNNL_ARG_ATTR_ZERO_POINTS</span></a>. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4NK4dnnl14primitive_attr12get_post_opsEv">
<span id="_CPPv3NK4dnnl14primitive_attr12get_post_opsEv"></span><span id="_CPPv2NK4dnnl14primitive_attr12get_post_opsEv"></span><span id="dnnl::primitive_attr::get_post_opsC"></span><span class="target" id="structdnnl_1_1primitive__attr_1a05664ef63c94acbcc59e921c4a4da6b8"></span><em class="property">const</em> <a class="reference internal" href="post-ops.html#_CPPv4N4dnnl8post_opsE" title="dnnl::post_ops">post_ops</a> <code class="sig-name descname">get_post_ops</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv4NK4dnnl14primitive_attr12get_post_opsEv" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Returns post-ops previously set via <a class="reference internal" href="#structdnnl_1_1primitive__attr_1ac830fa9f4fcf480b494d73153ad579bf"><span class="std std-ref">set_post_ops()</span></a>.</p>
<p><dl class="simple">
<dt><strong>Return</strong></dt><dd><p>Post-ops. </p>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl14primitive_attr12set_post_opsEK8post_ops">
<span id="_CPPv3N4dnnl14primitive_attr12set_post_opsEK8post_ops"></span><span id="_CPPv2N4dnnl14primitive_attr12set_post_opsEK8post_ops"></span><span id="dnnl::primitive_attr::set_post_ops__post_opsC"></span><span class="target" id="structdnnl_1_1primitive__attr_1ac830fa9f4fcf480b494d73153ad579bf"></span>void <code class="sig-name descname">set_post_ops</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="post-ops.html#_CPPv4N4dnnl8post_opsE" title="dnnl::post_ops">post_ops</a> <em>ops</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl14primitive_attr12set_post_opsEK8post_ops" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Sets post-ops.</p>
<p><dl class="simple">
<dt><strong>Note</strong></dt><dd><p>There is no way to check whether the post-ops would be supported by the target primitive. Any error will be reported by the respective primitive descriptor constructor.</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ops</span></code>: Post-ops object to copy post-ops from. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl14primitive_attr20set_rnn_data_qparamsEff">
<span id="_CPPv3N4dnnl14primitive_attr20set_rnn_data_qparamsEff"></span><span id="_CPPv2N4dnnl14primitive_attr20set_rnn_data_qparamsEff"></span><span id="dnnl::primitive_attr::set_rnn_data_qparams__float.float"></span><span class="target" id="structdnnl_1_1primitive__attr_1a39ce5aa8b06ed331d8e2158108cc8324"></span>void <code class="sig-name descname">set_rnn_data_qparams</code><span class="sig-paren">(</span>float <em>scale</em>, float <em>shift</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl14primitive_attr20set_rnn_data_qparamsEff" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Sets quantization scale and shift parameters for RNN data tensors.</p>
<p>For performance reasons, the low-precision configuration of the RNN primitives expect input activations to have the unsigned 8-bit integer data type. The scale and shift parameters are used to quantize floating-point data to unsigned integer and must be passed to the RNN primitive using attributes.</p>
<p>The quantization formula is <code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">*</span> <span class="pre">(data</span> <span class="pre">+</span> <span class="pre">shift)</span></code>.</p>
<p>Example usage: <div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">RNN</span> <span class="n">parameters</span>
<span class="nb">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mb</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">sic</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">slc</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">dic</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">dlc</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
<span class="o">//</span> <span class="n">Activations</span> <span class="n">quantization</span> <span class="n">parameters</span>
<span class="nb">float</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">2.0</span><span class="n">f</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="mf">0.5</span><span class="n">f</span><span class="p">;</span>

<span class="n">primitive_attr</span> <span class="n">attr</span><span class="p">;</span>

<span class="o">//</span> <span class="n">Set</span> <span class="n">scale</span> <span class="ow">and</span> <span class="n">shift</span> <span class="k">for</span> <span class="n">int8</span> <span class="n">quantization</span> <span class="n">of</span> <span class="n">activation</span>
<span class="n">attr</span><span class="o">.</span><span class="n">set_rnn_data_qparams</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">shift</span><span class="p">);</span>

<span class="o">//</span> <span class="n">Create</span> <span class="ow">and</span> <span class="n">configure</span> <span class="n">rnn</span> <span class="n">op_desc</span>
<span class="n">vanilla_rnn_forward</span><span class="p">::</span><span class="n">desc</span> <span class="n">rnn_d</span><span class="p">(</span><span class="o">/*</span> <span class="n">arguments</span> <span class="o">*/</span><span class="p">);</span>
<span class="n">vanilla_rnn_forward</span><span class="p">::</span><span class="n">primitive_desc</span> <span class="n">rnn_d</span><span class="p">(</span><span class="n">rnn_d</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">engine</span><span class="p">);</span>
</pre></div>
</div>
</p>
<p><dl class="simple">
<dt><strong>Note</strong></dt><dd><p>Quantization scale and shift are common for src_layer, src_iter, dst_iter, and dst_layer.</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code>: The value to scale the data by. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shift</span></code>: The value to shift the data by. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv4N4dnnl14primitive_attr23set_rnn_weights_qparamsEiRKNSt6vectorIfEE">
<span id="_CPPv3N4dnnl14primitive_attr23set_rnn_weights_qparamsEiRKNSt6vectorIfEE"></span><span id="_CPPv2N4dnnl14primitive_attr23set_rnn_weights_qparamsEiRKNSt6vectorIfEE"></span><span id="dnnl::primitive_attr::set_rnn_weights_qparams__i.std::vector:float:CR"></span><span class="target" id="structdnnl_1_1primitive__attr_1a61bd70f97baa628fd49b2c8b334b913e"></span>void <code class="sig-name descname">set_rnn_weights_qparams</code><span class="sig-paren">(</span>int <em>mask</em>, <em class="property">const</em> std::vector&lt;float&gt; &amp;<em>scales</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4dnnl14primitive_attr23set_rnn_weights_qparamsEiRKNSt6vectorIfEE" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Sets quantization scaling factors for RNN weights tensors. The low-precision configuration of the RNN primitives expect input weights to use the signed 8-bit integer data type. The scaling factors are used to quantize floating-point data to signed integer and must be passed to RNN primitives using attributes.</p>
<p><dl class="simple">
<dt><strong>Note</strong></dt><dd><p>The dimension order is always native and does not depend on the actual layout used. For example, five-dimensional weights always have (l, d, i, g, o) logical dimension ordering.</p>
</dd>
<dt><strong>Note</strong></dt><dd><p>Quantization scales are common for weights_layer and weights_iteration</p>
</dd>
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mask</span></code>: Scaling factors correspondence mask that defines the correspondence between the output tensor dimensions and the <code class="docutils literal notranslate"><span class="pre">scales</span></code> vector. The set i-th bit indicates that a dedicated scaling factor should be used each index along that dimension. Set the mask to 0 to use a common scaling factor for the whole output tensor. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scales</span></code>: Constant vector of output scaling factors. The following equality must hold: <span class="math notranslate nohighlight">\(scales.size() = \prod\limits_{d \in mask} weights.dims[d].\)</span> Violations can only be detected when the attributes are used to create a primitive descriptor. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="scratchpad.html" class="btn btn-neutral float-right" title="Scratchpad Mode" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../general.html" class="btn btn-neutral float-left" title="Common definitions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Intel Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>